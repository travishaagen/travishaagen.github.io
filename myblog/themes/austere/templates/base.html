{% import "macros/head.html" as head -%}
{% import "macros/opengraph.html" as social -%}
{% import "macros/hooks.html" as hooks -%}
{% import "macros/images.html" as images -%}
{% import "macros/icons.html" as icons -%}
<!DOCTYPE html>
<html lang="en">
<head>
    {%- block general_meta -%}
    {{ head::general_meta() }}
    {%- endblock general_meta -%}
    {%- block og_preview -%}
    {{ social::og_preview() }}
    {%- endblock og_preview -%}
    {% block rss -%}
    <link rel="alternate" type="application/atom+xml" title="{{config.title}}" href="{{ get_url(path='atom.xml',trailing_slash=false)|safe}}">
    {% endblock rss -%}
    {% if config.extra.favicon %}<link rel="icon" href="{{ config.extra.favicon }}">{% endif %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600&display=swap" rel="stylesheet"></noscript>
    {% set nav_count = config.extra.menu_links | length -%}
    {% if nav_count >= 6 -%}
    {% set_global items_per_row = ((nav_count + 1) / 2) | round -%}
    {% else -%}
    {% set_global items_per_row = nav_count -%}
    {% endif -%}
    {% set basis = (100 / items_per_row) | round -%}
    <style>
html{font-family:"Source Serif 4",Georgia,serif;font-size:1rem;line-height:1.7;margin:auto;max-width:100ch;padding:1.5rem 1em 3em}
img{max-width:100%}img:not([src$=".svg"]),article>div,blockquote,pre{border-radius:.4rem}img[src$="#pixelate"]{image-rendering:pixelated}
h1,h2,h3,h4,h5,h6{font-family:"Source Serif 4",Georgia,serif;font-weight:600;letter-spacing:-0.01em;margin:1.5rem 0 .75rem}
h1{font-size:1.75rem}h2{font-size:1.375rem}h3{font-size:1.125rem}
p{text-align:justify}p,ul,ol,article>footer,article>header{margin:0 0 1.5rem}
pre,blockquote{padding:1.5rem;margin:0 0 1.5rem}pre{overflow-x:auto;font-size:.875rem;line-height:1.5}pre code{background:0!important;padding:0;font-size:inherit}code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:.9em;padding:.15em .4em;border-radius:.25rem}blockquote>*:last-child{margin-bottom:0}
article>img,article>p>img,article>div{display:block;margin-bottom:1.5rem;width:100%}
.yt{aspect-ratio:16/9;width:100%;overflow:hidden}.yt iframe{width:100%;height:100%;border:0}
.s{font-size:.85rem}
.theme{display:inline-block;width:1.125rem;height:1.125rem;vertical-align:middle;margin-bottom:.15rem}.theme img,.theme svg{width:100%;height:100%}
html.light .theme img:first-child,html.light .theme svg:first-child,html.dark .theme img:last-child,html.dark .theme svg:last-child{display:none}
header strong{font-family:"Source Serif 4",Georgia,serif;font-weight:600;color:var(--accent)}.site-icon{width:2.25rem;height:2.25rem;vertical-align:middle;margin-right:1rem;color:var(--accent)}.header-brand{display:flex;align-items:center}.custom-icon{height:auto;max-height:3rem;width:auto;margin-right:1rem}body>footer{display:flex;justify-content:space-between;flex-wrap:wrap;gap:.5rem}
body>footer img,body>footer svg{width:1em;height:1em;vertical-align:-0.125em}
.tags{list-style:none;padding:0;margin:.75rem 0 0;display:flex;flex-wrap:wrap;gap:.5rem 1rem}.tags li{display:inline}
nav{display:flex;flex-wrap:wrap;gap:.5rem 1.5rem;margin-bottom:1.5rem}nav a{font-weight:500}nav img,nav svg{display:none}
.p{list-style:none;padding:0;margin:0 0 1.5rem}.p li{display:flex;gap:1.5rem;margin-bottom:.75rem;align-items:baseline}.p li:last-child{margin-bottom:0}.p time{opacity:.7;flex-shrink:0}
.profile-pic{width:8rem;height:8rem;border-radius:50%;object-fit:cover;display:block;margin:0 auto 1.5rem}
.projects .project{margin-bottom:1.5rem}.project header{display:flex;align-items:baseline;gap:.75rem;margin-bottom:.75rem}.project header h2{margin:0;font-size:1.375rem}.project-emoji{font-size:1.5rem}.project-image{max-width:200px;aspect-ratio:1;object-fit:cover;float:right;margin:0 0 1.5rem 1.5rem;border-radius:.4rem}.project p{margin-bottom:.75rem}.project .tags{margin:0}
.lb{position:fixed;inset:0;background:#000d;display:flex;align-items:center;justify-content:center;z-index:999;cursor:pointer}.lb img{max-width:95vw;max-height:95vh}
@media(max-width:30em){header .desc{display:none}{% if nav_count >= 6 %}nav{flex-wrap:wrap;row-gap:1.5rem}nav a{flex-basis:{{basis}}%}{% endif %}}
    </style>

    {# Colour configuration with defaults #}
    {% set light_bg = config.extra.colours.light.background | default(value="#FAF7F2") %}
    {% set light_text = config.extra.colours.light.text | default(value="#1a1a1a") %}
    {% set light_text_muted = config.extra.colours.light.text_muted | default(value="#3a3a3a") %}
    {% set light_accent = config.extra.colours.light.accent | default(value="#B85450") %}
    {% set light_accent_hover = config.extra.colours.light.accent_hover | default(value="#7A3533") %}
    {% set light_code_bg = config.extra.colours.light.code_bg | default(value="#f0ebe3") %}
    {% set light_border = config.extra.colours.light.border | default(value="#e0d9ce") %}
    {% set dark_bg = config.extra.colours.dark.background | default(value="#141413") %}
    {% set dark_text = config.extra.colours.dark.text | default(value="#e8e8e8") %}
    {% set dark_text_muted = config.extra.colours.dark.text_muted | default(value="#a0a0a0") %}
    {% set dark_accent = config.extra.colours.dark.accent | default(value="#E07A5F") %}
    {% set dark_accent_hover = config.extra.colours.dark.accent_hover | default(value="#F4A594") %}
    {% set dark_code_bg = config.extra.colours.dark.code_bg | default(value="#1e1e1d") %}
    {% set dark_border = config.extra.colours.dark.border | default(value="#2a2a29") %}
    <style>
    /* Light theme */
    html.light{background:{{light_bg}};--tc:{{light_bg}};--accent:{{light_accent}};--accent-hover:{{light_accent_hover}};color:{{light_text}}}
    html.light a{color:var(--accent);text-decoration:underline}
    html.light a:visited{color:var(--accent)}
    html.light a:hover{color:var(--accent-hover)}
    html.light header>div>span>a{text-decoration:none}html.light header>div>span>a:hover{text-decoration:underline}
    html.light p,html.light ul,html.light ol,html.light .desc{color:{{light_text_muted}}}
    html.light h1,html.light h2,html.light h3,html.light h4,html.light h5,html.light h6{color:{{light_text}}}
    html.light strong{color:{{light_text}}}html.light header strong{color:var(--accent)}
    html.light blockquote{border-left:3px solid var(--accent);color:#555}
    html.light pre,html.light article>img,html.light article>p>img{background:{{light_code_bg}}}
    html.light code{background:{{light_code_bg}};color:{{light_text}}}
    html.light hr{border-color:{{light_border}}}
    /* Light syntax highlighting */
    html.light .z-comment{color:#6a737d;font-style:italic}html.light .z-keyword{color:#d73a49}html.light .z-string{color:#22863a}html.light .z-number{color:#005cc5}html.light .z-function{color:#6f42c1}html.light .z-type{color:#005cc5}html.light .z-constant{color:#005cc5}html.light .z-variable{color:#e36209}html.light .z-attribute{color:#6f42c1}html.light .z-tag{color:#22863a}html.light .z-operator{color:#d73a49}html.light .z-punctuation{color:#24292e}html.light .z-builtin{color:#6f42c1}html.light .z-label{color:#005cc5}html.light .z-namespace{color:#e36209}
    /* Dark theme */
    html.dark{background:{{dark_bg}};--tc:{{dark_bg}};--accent:{{dark_accent}};--accent-hover:{{dark_accent_hover}};color:{{dark_text}}}
    html.dark a{color:var(--accent);text-decoration:underline}
    html.dark a:visited{color:var(--accent)}
    html.dark a:hover{color:var(--accent-hover)}
    html.dark header>div>span>a{text-decoration:none}html.dark header>div>span>a:hover{text-decoration:underline}
    html.dark p,html.dark ul,html.dark ol,html.dark .desc{color:{{dark_text_muted}}}
    html.dark h1,html.dark h2,html.dark h3,html.dark h4,html.dark h5,html.dark h6{color:#fff}
    html.dark strong{color:#fff}html.dark header strong{color:var(--accent)}
    html.dark blockquote{border-left:3px solid var(--accent);color:{{dark_text_muted}}}
    html.dark img[src$=".svg"],html.dark nav svg,html.dark .theme svg,html.dark footer svg{filter:invert(1)}
    html.dark pre,html.dark article>img,html.dark article>p>img{background:{{dark_code_bg}}}
    html.dark code{background:{{dark_code_bg}};color:{{dark_text}}}
    html.dark hr{border-color:{{dark_border}}}
    /* Dark syntax highlighting */
    html.dark .z-comment{color:#8b949e;font-style:italic}html.dark .z-keyword{color:#ff7b72}html.dark .z-string{color:#a5d6ff}html.dark .z-number{color:#79c0ff}html.dark .z-function{color:#d2a8ff}html.dark .z-type{color:#79c0ff}html.dark .z-constant{color:#79c0ff}html.dark .z-variable{color:#ffa657}html.dark .z-attribute{color:#d2a8ff}html.dark .z-tag{color:#7ee787}html.dark .z-operator{color:#ff7b72}html.dark .z-punctuation{color:#c9d1d9}html.dark .z-builtin{color:#d2a8ff}html.dark .z-label{color:#79c0ff}html.dark .z-namespace{color:#ffa657}
    /* Shared styles */
    a.active{color:var(--accent)}
    a:focus-visible{outline:2px solid currentColor;outline-offset:2px;border-radius:2px}
    hr{border:0;border-top:1px solid;clear:both;margin:1.5rem 0}
    blockquote{border-left:3px solid var(--accent);padding-left:1.25rem;font-style:italic}
    .skip-link{position:absolute;top:-100%;left:0;padding:.5rem 1rem;background:var(--accent);color:#fff;z-index:1000}.skip-link:focus{top:0}
    </style>
    <meta name="theme-color" id="tc"><script>(function(){var m=matchMedia('(prefers-color-scheme:dark)'),t=localStorage.theme||(m.matches?'dark':'light'),h=document.documentElement,c=document.getElementById('tc');h.className=t;function u(){c.content=getComputedStyle(h).getPropertyValue('--tc')}u();window.T=function(){t=t==='dark'?'light':'dark';localStorage.theme=t;h.className=t;u()}})()</script>
    {% block head_extra %}{% endblock head_extra %}
</head>
<body>
    <a href="#main" class="skip-link">Skip to content</a>
    {% if config.extra.inline_icons %}{{ icons::sprite() }}{% endif %}
    <header>
        <div style="display:flex;justify-content:space-between;align-items:center">
            <span class="header-brand">{% if config.extra.site_icon is defined %}{% if config.extra.site_icon == "" or config.extra.site_icon == "quill.svg" %}<svg class="site-icon" viewBox="-116.42 -116.42 596.66 596.66" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><defs><mask id="m"><rect x="-116.42" y="-116.42" width="596.66" height="596.66" fill="white"/><path fill="black" transform="translate(181.91,181.91) scale(1.25) translate(-181.91,-181.91)" d="M358.872,0.841c-3.196-1.538-7.014-0.931-9.572,1.526c-19.515,18.728-53.141,46.415-102.511,71.961c-2.159,1.118-3.737,3.106-4.333,5.463c-4.028,15.908-11.933,33.271-23.492,51.607l-4.705,7.462l8.772-38.205c0.715-3.115-0.378-6.368-2.828-8.42c-2.451-2.052-5.846-2.556-8.786-1.303l-1.015,0.428C110.79,133.291,81.352,198.24,72.67,233.22c-3.013,12.141-4.516,24.163-4.465,35.738c0.02,4.466,0.272,8.722,0.75,12.705l-66.39,67.703c-3.211,3.273-3.246,8.505-0.078,11.822c1.667,1.745,3.904,2.629,6.149,2.629c2.02,0,4.045-0.717,5.664-2.164l182.428-163.851c0.896,0.059-103.874,109.806-102.925,109.806c14.22,0,33.863-6.555,56.804-18.95c30.935-16.717,65.508-42.37,99.979-74.185c2.832-2.612,3.551-6.805,1.753-10.213c-1.798-3.407-5.662-5.181-9.42-4.315l-21.363,4.904l7.465-4.706c20.835-13.136,40.313-21.511,57.891-24.897c1.901-0.367,3.622-1.372,4.875-2.849c41.348-48.75,58.853-96.919,66.256-128.743c2.69-11.567,4.579-23.134,5.607-34.38C363.972,5.742,362.069,2.379,358.872,0.841z"/></mask></defs><rect x="-116.42" y="-116.42" width="596.66" height="596.66" rx="298.33" fill="currentColor" mask="url(#m)"/></svg>{% else %}<img src="{{ config.extra.site_icon }}" class="custom-icon" alt="">{% endif %}{% endif %}<a href="{{ config.base_url | safe }}"><strong>{{ config.title }}</strong></a>{% if config.extra.strapline %}<span class="desc"> · {{ config.extra.strapline }}</span>{% endif %}</span>
            <a href="#" onclick="T();return false" class="theme" aria-label="Toggle theme" title="Toggle theme">{% if config.extra.inline_icons %}{{ icons::icon(name="light.svg") }}{{ icons::icon(name="asleep.svg") }}{% else %}<img src="/icons/light.svg" alt="Light mode"><img src="/icons/asleep.svg" alt="Dark mode">{% endif %}</a>
        </div>
        <hr>
        <nav>
            {% for menu_link in config.extra.menu_links -%}
            {% set link_url = menu_link.url | replace(from="$BASE_URL", to=config.base_url) -%}
            {% set current_url_slash = current_url ~ "/" -%}
            {% set base_url_slash = config.base_url ~ "/" -%}
            {% set is_home = link_url == config.base_url or link_url == base_url_slash -%}
            {% set is_active = current_url == link_url or current_url_slash == link_url or (not is_home and current_url is starting_with(link_url)) -%}
            <a href="{{ link_url | safe}}"{% if current_url and is_active %} class="active"{% endif %}>{{menu_link.name}}</a>
            {% endfor -%}
        </nav>
    </header>
    <hr>
    <main id="main">
    {% block content -%}
    {% endblock -%}
    </main>
    <hr>
    <footer class="s">
        {% if config.extra.footer_text %}<span>{{ config.extra.footer_text | safe }}</span>{% endif %}
        {% if config.generate_feeds %}<span>Feeds: <a href="{{ get_url(path='atom.xml',trailing_slash=false)|safe }}">Atom</a> · <a href="{{ get_url(path='rss.xml',trailing_slash=false)|safe }}">RSS</a></span>{% endif %}
    </footer>
    {% block body_end -%}
    {# Analytics: Umami #}
    {% if config.extra.umami_website_id -%}
    <script defer src="{{ config.extra.umami_src | default(value='https://cloud.umami.is/script.js') | safe }}" data-website-id="{{ config.extra.umami_website_id }}"{% if config.extra.umami_domains %} data-domains="{{ config.extra.umami_domains }}"{% endif %}></script>
    {% endif -%}
    {# Analytics: Google Analytics #}
    {% if config.extra.google_analytics_tag_id -%}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ config.extra.google_analytics_tag_id }}"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','{{ config.extra.google_analytics_tag_id }}')</script>
    {% endif -%}
    {# Lightbox #}
    <script>document.querySelectorAll('article img[srcset]').forEach(i=>{if(i.closest('a'))return;i.style.cursor='pointer';i.onclick=()=>{let d=document.createElement('div'),s=i.srcset.split(',').pop().trim().split(' ')[0];d.className='lb';d.innerHTML='<img src="'+s+'">';document.body.style.overflow='hidden';d.onclick=()=>{d.remove();document.body.style.overflow=''};document.body.appendChild(d)}})</script>
    {% endblock body_end -%}
</body>
</html>
